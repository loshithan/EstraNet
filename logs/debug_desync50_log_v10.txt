2026-02-17 18:40:44.114399: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-02-17 18:40:45.250732: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
Starting evaluation script...
Script initialization complete. Calling main...
Entered run_comparison
Checking data: data/ASCAD_desync50.h5
Data found. Starting Mamba eval...

[Mamba-GNN] Evaluating on data/ASCAD_desync50.h5...
[Mamba-GNN] Imported OptimizedMambaGNN
[Mamba-GNN] Using device: cpu
[Mamba-GNN] Fitting Scaler on profiling data...
[Mamba-GNN] Transforming attack traces...
Optimized Mamba-GNN:
  d_model: 192, Mamba layers: 4, GNN layers: 3
  Input scaling: 0.1
[Mamba-GNN] Loading checkpoint: checkpoints/best_mamba_gnn_tunned.pth
[Mamba-GNN] Running Inference...

  0%|          | 0/100 [00:00<?, ?it/s]
  1%|1         | 1/100 [00:00<00:12,  7.88it/s]
  2%|2         | 2/100 [00:00<00:11,  8.61it/s]
  3%|3         | 3/100 [00:00<00:10,  8.84it/s]
  4%|4         | 4/100 [00:00<00:10,  8.96it/s]
  5%|5         | 5/100 [00:00<00:10,  9.10it/s]
  6%|6         | 6/100 [00:00<00:10,  9.15it/s]
  7%|7         | 7/100 [00:00<00:10,  9.17it/s]
  8%|8         | 8/100 [00:00<00:10,  9.20it/s]
  9%|9         | 9/100 [00:00<00:09,  9.14it/s]
 10%|#         | 10/100 [00:01<00:09,  9.21it/s]
 11%|#1        | 11/100 [00:01<00:09,  9.11it/s]
 12%|#2        | 12/100 [00:01<00:09,  9.11it/s]
 13%|#3        | 13/100 [00:01<00:09,  9.17it/s]
 14%|#4        | 14/100 [00:01<00:09,  9.10it/s]
 15%|#5        | 15/100 [00:01<00:09,  8.84it/s]
 16%|#6        | 16/100 [00:01<00:09,  8.70it/s]
 17%|#7        | 17/100 [00:01<00:09,  8.85it/s]
 18%|#8        | 18/100 [00:02<00:09,  8.99it/s]
 19%|#9        | 19/100 [00:02<00:08,  9.04it/s]
 20%|##        | 20/100 [00:02<00:08,  9.14it/s]
 21%|##1       | 21/100 [00:02<00:08,  9.16it/s]
 22%|##2       | 22/100 [00:02<00:08,  9.16it/s]
 23%|##3       | 23/100 [00:02<00:08,  9.24it/s]
 24%|##4       | 24/100 [00:02<00:08,  9.26it/s]
 25%|##5       | 25/100 [00:02<00:08,  9.30it/s]
 26%|##6       | 26/100 [00:02<00:07,  9.33it/s]
 27%|##7       | 27/100 [00:02<00:07,  9.36it/s]
 28%|##8       | 28/100 [00:03<00:07,  9.29it/s]
 29%|##9       | 29/100 [00:03<00:07,  9.33it/s]
 30%|###       | 30/100 [00:03<00:07,  9.36it/s]
 31%|###1      | 31/100 [00:03<00:07,  9.26it/s]
 32%|###2      | 32/100 [00:03<00:07,  9.31it/s]
 33%|###3      | 33/100 [00:03<00:07,  9.34it/s]
 34%|###4      | 34/100 [00:03<00:07,  9.36it/s]
 35%|###5      | 35/100 [00:03<00:06,  9.34it/s]
 36%|###6      | 36/100 [00:03<00:06,  9.37it/s]
 37%|###7      | 37/100 [00:04<00:06,  9.38it/s]
 38%|###8      | 38/100 [00:04<00:06,  9.39it/s]
 39%|###9      | 39/100 [00:04<00:06,  9.39it/s]
 40%|####      | 40/100 [00:04<00:06,  9.40it/s]
 41%|####1     | 41/100 [00:04<00:06,  9.39it/s]
 42%|####2     | 42/100 [00:04<00:06,  9.43it/s]
 43%|####3     | 43/100 [00:04<00:06,  9.37it/s]
 44%|####4     | 44/100 [00:04<00:05,  9.39it/s]
 45%|####5     | 45/100 [00:04<00:05,  9.35it/s]
 46%|####6     | 46/100 [00:04<00:05,  9.39it/s]
 47%|####6     | 47/100 [00:05<00:05,  9.35it/s]
 48%|####8     | 48/100 [00:05<00:05,  9.36it/s]
 49%|####9     | 49/100 [00:05<00:05,  9.34it/s]
 50%|#####     | 50/100 [00:05<00:05,  9.35it/s]
 51%|#####1    | 51/100 [00:05<00:05,  9.37it/s]
 52%|#####2    | 52/100 [00:05<00:05,  9.37it/s]
 53%|#####3    | 53/100 [00:05<00:05,  9.34it/s]
 54%|#####4    | 54/100 [00:05<00:04,  9.36it/s]
 55%|#####5    | 55/100 [00:05<00:04,  9.38it/s]
 56%|#####6    | 56/100 [00:06<00:04,  9.39it/s]
 57%|#####6    | 57/100 [00:06<00:04,  9.37it/s]
 58%|#####8    | 58/100 [00:06<00:04,  9.34it/s]
 59%|#####8    | 59/100 [00:06<00:04,  9.35it/s]
 60%|######    | 60/100 [00:06<00:04,  9.34it/s]
 61%|######1   | 61/100 [00:06<00:04,  9.20it/s]
 62%|######2   | 62/100 [00:06<00:04,  9.15it/s]
 63%|######3   | 63/100 [00:06<00:04,  9.17it/s]
 64%|######4   | 64/100 [00:06<00:03,  9.24it/s]
 65%|######5   | 65/100 [00:07<00:03,  9.26it/s]
 66%|######6   | 66/100 [00:07<00:03,  9.30it/s]
 67%|######7   | 67/100 [00:07<00:03,  9.29it/s]
 68%|######8   | 68/100 [00:07<00:03,  9.27it/s]
 69%|######9   | 69/100 [00:07<00:03,  9.28it/s]
 70%|#######   | 70/100 [00:07<00:03,  9.31it/s]
 71%|#######1  | 71/100 [00:07<00:03,  9.29it/s]
 72%|#######2  | 72/100 [00:07<00:03,  9.30it/s]
 73%|#######3  | 73/100 [00:07<00:02,  9.30it/s]
 74%|#######4  | 74/100 [00:08<00:02,  9.34it/s]
 75%|#######5  | 75/100 [00:08<00:02,  9.34it/s]
 76%|#######6  | 76/100 [00:08<00:02,  9.41it/s]
 77%|#######7  | 77/100 [00:08<00:02,  9.39it/s]
 78%|#######8  | 78/100 [00:08<00:02,  9.26it/s]
 79%|#######9  | 79/100 [00:08<00:02,  9.10it/s]
 80%|########  | 80/100 [00:08<00:02,  9.06it/s]
 81%|########1 | 81/100 [00:08<00:02,  9.03it/s]
 82%|########2 | 82/100 [00:08<00:02,  8.76it/s]
 83%|########2 | 83/100 [00:09<00:01,  8.84it/s]
 84%|########4 | 84/100 [00:09<00:01,  8.88it/s]
 85%|########5 | 85/100 [00:09<00:01,  8.78it/s]
 86%|########6 | 86/100 [00:09<00:01,  8.74it/s]
 87%|########7 | 87/100 [00:09<00:01,  8.77it/s]
 88%|########8 | 88/100 [00:09<00:01,  8.87it/s]
 89%|########9 | 89/100 [00:09<00:01,  8.88it/s]
 90%|######### | 90/100 [00:09<00:01,  8.74it/s]
 91%|#########1| 91/100 [00:09<00:01,  8.73it/s]
 92%|#########2| 92/100 [00:10<00:00,  8.70it/s]
 93%|#########3| 93/100 [00:10<00:00,  8.68it/s]
 94%|#########3| 94/100 [00:10<00:00,  8.68it/s]
 95%|#########5| 95/100 [00:10<00:00,  8.51it/s]
 96%|#########6| 96/100 [00:10<00:00,  8.54it/s]
 97%|#########7| 97/100 [00:10<00:00,  8.50it/s]
 98%|#########8| 98/100 [00:10<00:00,  8.28it/s]
 99%|#########9| 99/100 [00:10<00:00,  8.30it/s]
100%|##########| 100/100 [00:10<00:00,  8.26it/s]
100%|##########| 100/100 [00:10<00:00,  9.10it/s]
[Mamba-GNN] Computing Rank...

[Mamba-GNN] Rank:   0%|          | 0/10000 [00:00<?, ?it/s]
[Mamba-GNN] Rank:   3%|3         | 324/10000 [00:00<00:02, 3232.73it/s]
[Mamba-GNN] Rank:   7%|6         | 694/10000 [00:00<00:02, 3507.17it/s]
[Mamba-GNN] Rank:  11%|#         | 1094/10000 [00:00<00:02, 3729.65it/s]
[Mamba-GNN] Rank:  15%|#4        | 1481/10000 [00:00<00:02, 3783.66it/s]
[Mamba-GNN] Rank:  19%|#8        | 1893/10000 [00:00<00:02, 3902.23it/s]
[Mamba-GNN] Rank:  23%|##2       | 2298/10000 [00:00<00:01, 3950.29it/s]
[Mamba-GNN] Rank:  27%|##6       | 2694/10000 [00:00<00:01, 3931.84it/s]
[Mamba-GNN] Rank:  31%|###       | 3088/10000 [00:00<00:01, 3514.26it/s]
[Mamba-GNN] Rank:  34%|###4      | 3448/10000 [00:00<00:02, 3183.66it/s]
[Mamba-GNN] Rank:  38%|###8      | 3850/10000 [00:01<00:01, 3408.45it/s]
[Mamba-GNN] Rank:  42%|####2     | 4241/10000 [00:01<00:01, 3546.43it/s]
[Mamba-GNN] Rank:  46%|####6     | 4622/10000 [00:01<00:01, 3618.17it/s]
[Mamba-GNN] Rank:  50%|#####     | 5020/10000 [00:01<00:01, 3720.15it/s]
[Mamba-GNN] Rank:  54%|#####4    | 5419/10000 [00:01<00:01, 3797.26it/s]
[Mamba-GNN] Rank:  58%|#####8    | 5820/10000 [00:01<00:01, 3857.59it/s]
[Mamba-GNN] Rank:  62%|######2   | 6222/10000 [00:01<00:00, 3903.93it/s]
[Mamba-GNN] Rank:  66%|######6   | 6634/10000 [00:01<00:00, 3967.26it/s]
[Mamba-GNN] Rank:  70%|#######   | 7033/10000 [00:01<00:00, 3949.22it/s]
[Mamba-GNN] Rank:  74%|#######4  | 7443/10000 [00:01<00:00, 3992.19it/s]
[Mamba-GNN] Rank:  78%|#######8  | 7850/10000 [00:02<00:00, 4014.81it/s]
[Mamba-GNN] Rank:  83%|########2 | 8253/10000 [00:02<00:00, 4013.11it/s]
[Mamba-GNN] Rank:  87%|########6 | 8655/10000 [00:02<00:00, 4003.32it/s]
[Mamba-GNN] Rank:  91%|######### | 9062/10000 [00:02<00:00, 4023.07it/s]
[Mamba-GNN] Rank:  95%|#########4| 9465/10000 [00:02<00:00, 4021.43it/s]
[Mamba-GNN] Rank:  99%|#########8| 9869/10000 [00:02<00:00, 4025.33it/s]
[Mamba-GNN] Final Rank: 66.0
[Mamba-GNN] Rank: 100%|##########| 10000/10000 [00:02<00:00, 3822.55it/s]
Starting Transformer eval...

[Transformer] Evaluating on data/ASCAD_desync50.h5...
File replaced with fixed version
Checkpoints deleted
NOW RESTART RUNTIME: Runtime -> Restart runtime
Then run your training again
WARNING:tensorflow:From C:\Users\User\AppData\Roaming\Python\Python313\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2026-02-17 18:41:00.209237: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[Transformer] Restoring from checkpoints/checkpoints_transformer_desync50\trans_long-5
[Transformer] Checkpoint restored.
[Transformer] Running Inference...

[1m 1/40[0m [37m====================[0m [1m1:30[0m 2s/step
[1m 2/40[0m [32m=[0m[37m===================[0m [1m1:10[0m 2s/step
[1m 3/40[0m [32m=[0m[37m===================[0m [1m1:08[0m 2s/step
[1m 4/40[0m [32m==[0m[37m==================[0m [1m1:06[0m 2s/step
[1m 5/40[0m [32m==[0m[37m==================[0m [1m1:04[0m 2s/step
[1m 6/40[0m [32m===[0m[37m=================[0m [1m1:02[0m 2s/step
[1m 7/40[0m [32m===[0m[37m=================[0m [1m1:01[0m 2s/step
[1m 8/40[0m [32m====[0m[37m================[0m [1m59s[0m 2s/step 
[1m 9/40[0m [32m====[0m[37m================[0m [1m57s[0m 2s/step
[1m10/40[0m [32m=====[0m[37m===============[0m [1m55s[0m 2s/step
[1m11/40[0m [32m=====[0m[37m===============[0m [1m53s[0m 2s/step
[1m12/40[0m [32m======[0m[37m==============[0m [1m51s[0m 2s/step
[1m13/40[0m [32m======[0m[37m==============[0m [1m50s[0m 2s/step
[1m14/40[0m [32m=======[0m[37m=============[0m [1m48s[0m 2s/step
[1m15/40[0m [32m=======[0m[37m=============[0m [1m46s[0m 2s/step
[1m16/40[0m [32m========[0m[37m============[0m [1m44s[0m 2s/step
[1m17/40[0m [32m========[0m[37m============[0m [1m43s[0m 2s/step
[1m18/40[0m [32m=========[0m[37m===========[0m [1m41s[0m 2s/step
[1m19/40[0m [32m=========[0m[37m===========[0m [1m39s[0m 2s/step
[1m20/40[0m [32m==========[0m[37m==========[0m [1m37s[0m 2s/step
[1m21/40[0m [32m==========[0m[37m==========[0m [1m35s[0m 2s/step
[1m22/40[0m [32m===========[0m[37m=========[0m [1m33s[0m 2s/step
[1m23/40[0m [32m===========[0m[37m=========[0m [1m32s[0m 2s/step
[1m24/40[0m [32m============[0m[37m========[0m [1m30s[0m 2s/step
[1m25/40[0m [32m============[0m[37m========[0m [1m28s[0m 2s/step
[1m26/40[0m [32m=============[0m[37m=======[0m [1m26s[0m 2s/step
[1m27/40[0m [32m=============[0m[37m=======[0m [1m24s[0m 2s/step
[1m28/40[0m [32m==============[0m[37m======[0m [1m22s[0m 2s/step
[1m29/40[0m [32m==============[0m[37m======[0m [1m20s[0m 2s/step
[1m30/40[0m [32m===============[0m[37m=====[0m [1m19s[0m 2s/step
[1m31/40[0m [32m===============[0m[37m=====[0m [1m17s[0m 2s/step
[1m32/40[0m [32m================[0m[37m====[0m [1m15s[0m 2s/step
[1m33/40[0m [32m================[0m[37m====[0m [1m13s[0m 2s/step
[1m34/40[0m [32m=================[0m[37m===[0m [1m11s[0m 2s/step
[1m35/40[0m [32m=================[0m[37m===[0m [1m9s[0m 2s/step 
[1m36/40[0m [32m==================[0m[37m==[0m [1m7s[0m 2s/step
[1m37/40[0m [32m==================[0m[37m==[0m [1m5s[0m 2s/step
[1m38/40[0m [32m===================[0m[37m=[0m [1m3s[0m 2s/step
[1m39/40[0m [32m===================[0m[37m=[0m [1m1s[0m 2s/step
[1m40/40[0m [32m====================[0m[37m[0m [1m0s[0m 2s/step
[1m40/40[0m [32m====================[0m[37m[0m [1m76s[0m 2s/step
[Transformer] Computing Rank...

[Transformer] Rank:   0%|          | 0/10000 [00:00<?, ?it/s]
[Transformer] Rank:   4%|3         | 366/10000 [00:00<00:02, 3655.97it/s]
[Transformer] Rank:   7%|7         | 732/10000 [00:00<00:02, 3614.90it/s]
[Transformer] Rank:  11%|#         | 1094/10000 [00:00<00:02, 3596.62it/s]
[Transformer] Rank:  15%|#4        | 1454/10000 [00:00<00:02, 3574.01it/s]
[Transformer] Rank:  18%|#8        | 1836/10000 [00:00<00:02, 3660.28it/s]
[Transformer] Rank:  22%|##2       | 2219/10000 [00:00<00:02, 3716.65it/s]
[Transformer] Rank:  26%|##5       | 2591/10000 [00:00<00:02, 3687.37it/s]
[Transformer] Rank:  30%|##9       | 2970/10000 [00:00<00:01, 3719.48it/s]
[Transformer] Rank:  34%|###3      | 3355/10000 [00:00<00:01, 3757.24it/s]
[Transformer] Rank:  37%|###7      | 3737/10000 [00:01<00:01, 3774.35it/s]
[Transformer] Rank:  41%|####1     | 4120/10000 [00:01<00:01, 3789.70it/s]
[Transformer] Rank:  45%|####5     | 4501/10000 [00:01<00:01, 3791.41it/s]
[Transformer] Rank:  49%|####8     | 4881/10000 [00:01<00:01, 3748.46it/s]
[Transformer] Rank:  53%|#####2    | 5256/10000 [00:01<00:01, 3717.40it/s]
[Transformer] Rank:  56%|#####6    | 5628/10000 [00:01<00:01, 3711.73it/s]
[Transformer] Rank:  60%|######    | 6000/10000 [00:01<00:01, 3694.55it/s]
[Transformer] Rank:  64%|######3   | 6370/10000 [00:01<00:00, 3659.07it/s]
[Transformer] Rank:  68%|######7   | 6757/10000 [00:01<00:00, 3720.45it/s]
[Transformer] Rank:  71%|#######1  | 7138/10000 [00:01<00:00, 3744.75it/s]
[Transformer] Rank:  75%|#######5  | 7523/10000 [00:02<00:00, 3775.04it/s]
[Transformer] Rank:  79%|#######9  | 7905/10000 [00:02<00:00, 3786.00it/s]
[Transformer] Rank:  83%|########2 | 8284/10000 [00:02<00:00, 3755.11it/s]
[Transformer] Rank:  87%|########6 | 8660/10000 [00:02<00:00, 3731.07it/s]
[Transformer] Rank:  90%|######### | 9040/10000 [00:02<00:00, 3750.34it/s]
[Transformer] Rank:  94%|#########4| 9418/10000 [00:02<00:00, 3757.93it/s]
[Transformer] Rank:  98%|#########7| 9794/10000 [00:02<00:00, 3758.08it/s]
[Transformer] Final Rank: 37.0
[Transformer] Rank: 100%|##########| 10000/10000 [00:02<00:00, 3728.46it/s]
Comparison plot saved to desync50_comparison.png
