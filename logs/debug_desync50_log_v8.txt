2026-02-17 18:33:54.036934: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-02-17 18:33:55.175212: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
Starting evaluation script...
Script initialization complete. Calling main...
Entered run_comparison
Checking data: data/ASCAD_desync50.h5
Data found. Starting Mamba eval...

[Mamba-GNN] Evaluating on data/ASCAD_desync50.h5...
[Mamba-GNN] Imported OptimizedMambaGNN
[Mamba-GNN] Using device: cpu
[Mamba-GNN] Fitting Scaler on profiling data...
[Mamba-GNN] Transforming attack traces...
Optimized Mamba-GNN:
  d_model: 192, Mamba layers: 4, GNN layers: 3
  Input scaling: 0.1
[Mamba-GNN] Loading checkpoint: checkpoints/best_mamba_gnn_tunned.pth
[Mamba-GNN] Running Inference...

  0%|          | 0/100 [00:00<?, ?it/s]
  1%|1         | 1/100 [00:00<00:24,  3.99it/s]
  2%|2         | 2/100 [00:00<00:16,  5.99it/s]
  3%|3         | 3/100 [00:00<00:13,  7.09it/s]
  4%|4         | 4/100 [00:00<00:12,  7.77it/s]
  5%|5         | 5/100 [00:00<00:11,  8.24it/s]
  6%|6         | 6/100 [00:00<00:11,  8.53it/s]
  7%|7         | 7/100 [00:00<00:10,  8.73it/s]
  8%|8         | 8/100 [00:01<00:10,  8.85it/s]
  9%|9         | 9/100 [00:01<00:10,  8.95it/s]
 10%|#         | 10/100 [00:01<00:09,  9.02it/s]
 11%|#1        | 11/100 [00:01<00:09,  8.95it/s]
 12%|#2        | 12/100 [00:01<00:09,  8.96it/s]
 13%|#3        | 13/100 [00:01<00:09,  9.03it/s]
 14%|#4        | 14/100 [00:01<00:09,  9.05it/s]
 15%|#5        | 15/100 [00:01<00:09,  9.00it/s]
 16%|#6        | 16/100 [00:01<00:09,  8.87it/s]
 17%|#7        | 17/100 [00:02<00:09,  8.97it/s]
 18%|#8        | 18/100 [00:02<00:09,  9.06it/s]
 19%|#9        | 19/100 [00:02<00:08,  9.10it/s]
 20%|##        | 20/100 [00:02<00:08,  9.14it/s]
 21%|##1       | 21/100 [00:02<00:08,  9.19it/s]
 22%|##2       | 22/100 [00:02<00:08,  9.22it/s]
 23%|##3       | 23/100 [00:02<00:08,  9.23it/s]
 24%|##4       | 24/100 [00:02<00:08,  9.26it/s]
 25%|##5       | 25/100 [00:02<00:08,  9.16it/s]
 26%|##6       | 26/100 [00:02<00:08,  9.20it/s]
 27%|##7       | 27/100 [00:03<00:07,  9.21it/s]
 28%|##8       | 28/100 [00:03<00:07,  9.23it/s]
 29%|##9       | 29/100 [00:03<00:07,  9.17it/s]
 30%|###       | 30/100 [00:03<00:07,  9.20it/s]
 31%|###1      | 31/100 [00:03<00:07,  9.14it/s]
 32%|###2      | 32/100 [00:03<00:07,  9.20it/s]
 33%|###3      | 33/100 [00:03<00:07,  9.21it/s]
 34%|###4      | 34/100 [00:03<00:07,  9.17it/s]
 35%|###5      | 35/100 [00:03<00:07,  9.18it/s]
 36%|###6      | 36/100 [00:04<00:07,  9.13it/s]
 37%|###7      | 37/100 [00:04<00:06,  9.21it/s]
 38%|###8      | 38/100 [00:04<00:06,  9.18it/s]
 39%|###9      | 39/100 [00:04<00:06,  9.23it/s]
 40%|####      | 40/100 [00:04<00:06,  9.20it/s]
 41%|####1     | 41/100 [00:04<00:06,  9.24it/s]
 42%|####2     | 42/100 [00:04<00:06,  9.25it/s]
 43%|####3     | 43/100 [00:04<00:06,  9.20it/s]
 44%|####4     | 44/100 [00:04<00:06,  9.14it/s]
 45%|####5     | 45/100 [00:05<00:06,  9.09it/s]
 46%|####6     | 46/100 [00:05<00:05,  9.14it/s]
 47%|####6     | 47/100 [00:05<00:05,  9.10it/s]
 48%|####8     | 48/100 [00:05<00:05,  9.16it/s]
 49%|####9     | 49/100 [00:05<00:05,  9.16it/s]
 50%|#####     | 50/100 [00:05<00:05,  9.19it/s]
 51%|#####1    | 51/100 [00:05<00:05,  9.21it/s]
 52%|#####2    | 52/100 [00:05<00:05,  9.25it/s]
 53%|#####3    | 53/100 [00:05<00:05,  9.22it/s]
 54%|#####4    | 54/100 [00:06<00:05,  9.19it/s]
 55%|#####5    | 55/100 [00:06<00:04,  9.19it/s]
 56%|#####6    | 56/100 [00:06<00:04,  9.18it/s]
 57%|#####6    | 57/100 [00:06<00:04,  9.19it/s]
 58%|#####8    | 58/100 [00:06<00:04,  9.16it/s]
 59%|#####8    | 59/100 [00:06<00:04,  9.16it/s]
 60%|######    | 60/100 [00:06<00:04,  9.16it/s]
 61%|######1   | 61/100 [00:06<00:04,  9.10it/s]
 62%|######2   | 62/100 [00:06<00:04,  8.91it/s]
 63%|######3   | 63/100 [00:07<00:04,  9.00it/s]
 64%|######4   | 64/100 [00:07<00:03,  9.08it/s]
 65%|######5   | 65/100 [00:07<00:03,  9.12it/s]
 66%|######6   | 66/100 [00:07<00:03,  9.14it/s]
 67%|######7   | 67/100 [00:07<00:03,  9.14it/s]
 68%|######8   | 68/100 [00:07<00:03,  9.14it/s]
 69%|######9   | 69/100 [00:07<00:03,  9.12it/s]
 70%|#######   | 70/100 [00:07<00:03,  9.11it/s]
 71%|#######1  | 71/100 [00:07<00:03,  9.15it/s]
 72%|#######2  | 72/100 [00:08<00:03,  9.16it/s]
 73%|#######3  | 73/100 [00:08<00:02,  9.20it/s]
 74%|#######4  | 74/100 [00:08<00:02,  9.18it/s]
 75%|#######5  | 75/100 [00:08<00:02,  9.20it/s]
 76%|#######6  | 76/100 [00:08<00:02,  9.20it/s]
 77%|#######7  | 77/100 [00:08<00:02,  9.22it/s]
 78%|#######8  | 78/100 [00:08<00:02,  9.23it/s]
 79%|#######9  | 79/100 [00:08<00:02,  9.20it/s]
 80%|########  | 80/100 [00:08<00:02,  9.14it/s]
 81%|########1 | 81/100 [00:08<00:02,  9.15it/s]
 82%|########2 | 82/100 [00:09<00:01,  9.16it/s]
 83%|########2 | 83/100 [00:09<00:01,  9.10it/s]
 84%|########4 | 84/100 [00:09<00:01,  9.08it/s]
 85%|########5 | 85/100 [00:09<00:01,  9.07it/s]
 86%|########6 | 86/100 [00:09<00:01,  9.08it/s]
 87%|########7 | 87/100 [00:09<00:01,  9.03it/s]
 88%|########8 | 88/100 [00:09<00:01,  8.98it/s]
 89%|########9 | 89/100 [00:09<00:01,  8.97it/s]
 90%|######### | 90/100 [00:09<00:01,  9.01it/s]
 91%|#########1| 91/100 [00:10<00:00,  9.02it/s]
 92%|#########2| 92/100 [00:10<00:00,  9.05it/s]
 93%|#########3| 93/100 [00:10<00:00,  8.99it/s]
 94%|#########3| 94/100 [00:10<00:00,  8.95it/s]
 95%|#########5| 95/100 [00:10<00:00,  8.90it/s]
 96%|#########6| 96/100 [00:10<00:00,  8.89it/s]
 97%|#########7| 97/100 [00:10<00:00,  8.87it/s]
 98%|#########8| 98/100 [00:10<00:00,  8.80it/s]
 99%|#########9| 99/100 [00:11<00:00,  8.79it/s]
100%|##########| 100/100 [00:11<00:00,  8.82it/s]
100%|##########| 100/100 [00:11<00:00,  9.00it/s]
[Mamba-GNN] Computing Rank...

[Mamba-GNN] Rank:   0%|          | 0/10000 [00:00<?, ?it/s]
[Mamba-GNN] Rank:   3%|3         | 335/10000 [00:00<00:02, 3348.78it/s]
[Mamba-GNN] Rank:   7%|7         | 732/10000 [00:00<00:02, 3709.63it/s]
[Mamba-GNN] Rank:  11%|#1        | 1137/10000 [00:00<00:02, 3863.53it/s]
[Mamba-GNN] Rank:  15%|#5        | 1547/10000 [00:00<00:02, 3954.11it/s]
[Mamba-GNN] Rank:  19%|#9        | 1948/10000 [00:00<00:02, 3973.11it/s]
[Mamba-GNN] Rank:  24%|##3       | 2352/10000 [00:00<00:01, 3993.43it/s]
[Mamba-GNN] Rank:  28%|##7       | 2755/10000 [00:00<00:01, 4004.20it/s]
[Mamba-GNN] Rank:  32%|###1      | 3163/10000 [00:00<00:01, 4027.34it/s]
[Mamba-GNN] Rank:  36%|###5      | 3579/10000 [00:00<00:01, 4068.25it/s]
[Mamba-GNN] Rank:  40%|###9      | 3990/10000 [00:01<00:01, 4079.29it/s]
[Mamba-GNN] Rank:  44%|####3     | 4398/10000 [00:01<00:01, 3661.41it/s]
[Mamba-GNN] Rank:  48%|####8     | 4812/10000 [00:01<00:01, 3793.87it/s]
[Mamba-GNN] Rank:  52%|#####2    | 5202/10000 [00:01<00:01, 3822.47it/s]
[Mamba-GNN] Rank:  56%|#####5    | 5596/10000 [00:01<00:01, 3854.59it/s]
[Mamba-GNN] Rank:  60%|#####9    | 5996/10000 [00:01<00:01, 3896.51it/s]
[Mamba-GNN] Rank:  64%|######3   | 6398/10000 [00:01<00:00, 3928.15it/s]
[Mamba-GNN] Rank:  68%|######7   | 6793/10000 [00:01<00:00, 3904.57it/s]
[Mamba-GNN] Rank:  72%|#######1  | 7185/10000 [00:01<00:00, 3762.33it/s]
[Mamba-GNN] Rank:  76%|#######5  | 7579/10000 [00:01<00:00, 3811.27it/s]
[Mamba-GNN] Rank:  80%|#######9  | 7965/10000 [00:02<00:00, 3825.03it/s]
[Mamba-GNN] Rank:  84%|########3 | 8369/10000 [00:02<00:00, 3887.98it/s]
[Mamba-GNN] Rank:  88%|########7 | 8772/10000 [00:02<00:00, 3923.21it/s]
[Mamba-GNN] Rank:  92%|#########1| 9182/10000 [00:02<00:00, 3973.07it/s]
[Mamba-GNN] Rank:  96%|#########5| 9591/10000 [00:02<00:00, 4003.47it/s]
[Mamba-GNN] Final Rank: 66.0
[Mamba-GNN] Rank: 100%|#########9| 9992/10000 [00:02<00:00, 3986.51it/s]
[Mamba-GNN] Rank: 100%|##########| 10000/10000 [00:02<00:00, 3905.57it/s]
Starting Transformer eval...

[Transformer] Evaluating on data/ASCAD_desync50.h5...
File replaced with fixed version
Checkpoints deleted
NOW RESTART RUNTIME: Runtime -> Restart runtime
Then run your training again
WARNING:tensorflow:From C:\Users\User\AppData\Roaming\Python\Python313\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2026-02-17 18:34:10.257617: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[Transformer] Restoring from checkpoints/checkpoints_transformer_desync50\trans_long-5
[Transformer] Checkpoint restored.
[Transformer] Running Inference...

[1m 1/40[0m [37m====================[0m [1m1:31[0m 2s/step
[1m 2/40[0m [32m=[0m[37m===================[0m [1m1:14[0m 2s/step
[1m 3/40[0m [32m=[0m[37m===================[0m [1m1:10[0m 2s/step
[1m 4/40[0m [32m==[0m[37m==================[0m [1m1:07[0m 2s/step
[1m 5/40[0m [32m==[0m[37m==================[0m [1m1:05[0m 2s/step
[1m 6/40[0m [32m===[0m[37m=================[0m [1m1:04[0m 2s/step
[1m 7/40[0m [32m===[0m[37m=================[0m [1m1:02[0m 2s/step
[1m 8/40[0m [32m====[0m[37m================[0m [1m1:00[0m 2s/step
[1m 9/40[0m [32m====[0m[37m================[0m [1m57s[0m 2s/step 
[1m10/40[0m [32m=====[0m[37m===============[0m [1m56s[0m 2s/step
[1m11/40[0m [32m=====[0m[37m===============[0m [1m54s[0m 2s/step
[1m12/40[0m [32m======[0m[37m==============[0m [1m52s[0m 2s/step
[1m13/40[0m [32m======[0m[37m==============[0m [1m50s[0m 2s/step
[1m14/40[0m [32m=======[0m[37m=============[0m [1m48s[0m 2s/step
[1m15/40[0m [32m=======[0m[37m=============[0m [1m46s[0m 2s/step
[1m16/40[0m [32m========[0m[37m============[0m [1m44s[0m 2s/step
[1m17/40[0m [32m========[0m[37m============[0m [1m42s[0m 2s/step
[1m18/40[0m [32m=========[0m[37m===========[0m [1m41s[0m 2s/step
[1m19/40[0m [32m=========[0m[37m===========[0m [1m39s[0m 2s/step
[1m20/40[0m [32m==========[0m[37m==========[0m [1m37s[0m 2s/step
[1m21/40[0m [32m==========[0m[37m==========[0m [1m35s[0m 2s/step
[1m22/40[0m [32m===========[0m[37m=========[0m [1m33s[0m 2s/step
[1m23/40[0m [32m===========[0m[37m=========[0m [1m31s[0m 2s/step
[1m24/40[0m [32m============[0m[37m========[0m [1m30s[0m 2s/step
[1m25/40[0m [32m============[0m[37m========[0m [1m28s[0m 2s/step
[1m26/40[0m [32m=============[0m[37m=======[0m [1m26s[0m 2s/step
[1m27/40[0m [32m=============[0m[37m=======[0m [1m24s[0m 2s/step
[1m28/40[0m [32m==============[0m[37m======[0m [1m22s[0m 2s/step
[1m29/40[0m [32m==============[0m[37m======[0m [1m20s[0m 2s/step
[1m30/40[0m [32m===============[0m[37m=====[0m [1m18s[0m 2s/step
[1m31/40[0m [32m===============[0m[37m=====[0m [1m17s[0m 2s/step
[1m32/40[0m [32m================[0m[37m====[0m [1m15s[0m 2s/step
[1m33/40[0m [32m================[0m[37m====[0m [1m13s[0m 2s/step
[1m34/40[0m [32m=================[0m[37m===[0m [1m11s[0m 2s/step
[1m35/40[0m [32m=================[0m[37m===[0m [1m9s[0m 2s/step 
[1m36/40[0m [32m==================[0m[37m==[0m [1m7s[0m 2s/step
[1m37/40[0m [32m==================[0m[37m==[0m [1m5s[0m 2s/step
[1m38/40[0m [32m===================[0m[37m=[0m [1m3s[0m 2s/step
[1m39/40[0m [32m===================[0m[37m=[0m [1m1s[0m 2s/step
[1m40/40[0m [32m====================[0m[37m[0m [1m0s[0m 2s/step
[1m40/40[0m [32m====================[0m[37m[0m [1m76s[0m 2s/step
[Transformer] Computing Rank...

[Transformer] Rank:   0%|          | 0/1 [00:00<?, ?it/s]
Transformer eval failed: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
[Transformer] Rank:   0%|          | 0/1 [00:00<?, ?it/s]
Comparison plot saved to desync50_comparison.png
