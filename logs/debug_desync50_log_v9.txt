2026-02-17 18:37:34.916682: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-02-17 18:37:36.030163: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
Starting evaluation script...
Script initialization complete. Calling main...
Entered run_comparison
Checking data: data/ASCAD_desync50.h5
Data found. Starting Mamba eval...

[Mamba-GNN] Evaluating on data/ASCAD_desync50.h5...
[Mamba-GNN] Imported OptimizedMambaGNN
[Mamba-GNN] Using device: cpu
[Mamba-GNN] Fitting Scaler on profiling data...
[Mamba-GNN] Transforming attack traces...
Optimized Mamba-GNN:
  d_model: 192, Mamba layers: 4, GNN layers: 3
  Input scaling: 0.1
[Mamba-GNN] Loading checkpoint: checkpoints/best_mamba_gnn_tunned.pth
[Mamba-GNN] Running Inference...

  0%|          | 0/100 [00:00<?, ?it/s]
  1%|1         | 1/100 [00:00<00:12,  7.75it/s]
  2%|2         | 2/100 [00:00<00:11,  8.68it/s]
  3%|3         | 3/100 [00:00<00:10,  8.83it/s]
  4%|4         | 4/100 [00:00<00:10,  8.91it/s]
  5%|5         | 5/100 [00:00<00:10,  8.97it/s]
  6%|6         | 6/100 [00:00<00:10,  9.10it/s]
  7%|7         | 7/100 [00:00<00:10,  9.06it/s]
  8%|8         | 8/100 [00:00<00:10,  8.92it/s]
  9%|9         | 9/100 [00:01<00:10,  9.06it/s]
 10%|#         | 10/100 [00:01<00:09,  9.04it/s]
 11%|#1        | 11/100 [00:01<00:09,  8.95it/s]
 12%|#2        | 12/100 [00:01<00:09,  9.03it/s]
 13%|#3        | 13/100 [00:01<00:09,  9.10it/s]
 14%|#4        | 14/100 [00:01<00:09,  9.15it/s]
 15%|#5        | 15/100 [00:01<00:09,  9.24it/s]
 16%|#6        | 16/100 [00:01<00:09,  9.25it/s]
 17%|#7        | 17/100 [00:01<00:09,  9.19it/s]
 18%|#8        | 18/100 [00:01<00:08,  9.25it/s]
 19%|#9        | 19/100 [00:02<00:08,  9.29it/s]
 20%|##        | 20/100 [00:02<00:08,  9.32it/s]
 21%|##1       | 21/100 [00:02<00:08,  9.30it/s]
 22%|##2       | 22/100 [00:02<00:08,  9.30it/s]
 23%|##3       | 23/100 [00:02<00:08,  9.36it/s]
 24%|##4       | 24/100 [00:02<00:08,  9.35it/s]
 25%|##5       | 25/100 [00:02<00:08,  9.35it/s]
 26%|##6       | 26/100 [00:02<00:07,  9.41it/s]
 27%|##7       | 27/100 [00:02<00:07,  9.37it/s]
 28%|##8       | 28/100 [00:03<00:07,  9.31it/s]
 29%|##9       | 29/100 [00:03<00:07,  9.31it/s]
 30%|###       | 30/100 [00:03<00:07,  9.39it/s]
 31%|###1      | 31/100 [00:03<00:07,  9.37it/s]
 32%|###2      | 32/100 [00:03<00:07,  9.42it/s]
 33%|###3      | 33/100 [00:03<00:07,  9.41it/s]
 34%|###4      | 34/100 [00:03<00:07,  9.35it/s]
 35%|###5      | 35/100 [00:03<00:06,  9.40it/s]
 36%|###6      | 36/100 [00:03<00:06,  9.44it/s]
 37%|###7      | 37/100 [00:04<00:06,  9.38it/s]
 38%|###8      | 38/100 [00:04<00:06,  8.97it/s]
 39%|###9      | 39/100 [00:04<00:06,  9.13it/s]
 40%|####      | 40/100 [00:04<00:06,  9.14it/s]
 41%|####1     | 41/100 [00:04<00:06,  9.09it/s]
 42%|####2     | 42/100 [00:04<00:06,  9.16it/s]
 43%|####3     | 43/100 [00:04<00:06,  9.07it/s]
 44%|####4     | 44/100 [00:04<00:06,  8.98it/s]
 45%|####5     | 45/100 [00:04<00:06,  9.06it/s]
 46%|####6     | 46/100 [00:05<00:05,  9.17it/s]
 47%|####6     | 47/100 [00:05<00:05,  9.18it/s]
 48%|####8     | 48/100 [00:05<00:05,  9.25it/s]
 49%|####9     | 49/100 [00:05<00:05,  9.29it/s]
 50%|#####     | 50/100 [00:05<00:05,  9.35it/s]
 51%|#####1    | 51/100 [00:05<00:05,  9.38it/s]
 52%|#####2    | 52/100 [00:05<00:05,  9.39it/s]
 53%|#####3    | 53/100 [00:05<00:05,  9.39it/s]
 54%|#####4    | 54/100 [00:05<00:04,  9.35it/s]
 55%|#####5    | 55/100 [00:05<00:04,  9.25it/s]
 56%|#####6    | 56/100 [00:06<00:04,  9.18it/s]
 57%|#####6    | 57/100 [00:06<00:04,  9.11it/s]
 58%|#####8    | 58/100 [00:06<00:04,  8.66it/s]
 59%|#####8    | 59/100 [00:06<00:04,  8.44it/s]
 60%|######    | 60/100 [00:06<00:04,  8.72it/s]
 61%|######1   | 61/100 [00:06<00:04,  8.93it/s]
 62%|######2   | 62/100 [00:06<00:04,  9.08it/s]
 63%|######3   | 63/100 [00:06<00:04,  9.15it/s]
 64%|######4   | 64/100 [00:06<00:03,  9.24it/s]
 65%|######5   | 65/100 [00:07<00:03,  9.30it/s]
 66%|######6   | 66/100 [00:07<00:03,  9.34it/s]
 67%|######7   | 67/100 [00:07<00:03,  9.38it/s]
 68%|######8   | 68/100 [00:07<00:03,  9.39it/s]
 69%|######9   | 69/100 [00:07<00:03,  9.36it/s]
 70%|#######   | 70/100 [00:07<00:03,  9.38it/s]
 71%|#######1  | 71/100 [00:07<00:03,  9.38it/s]
 72%|#######2  | 72/100 [00:07<00:02,  9.41it/s]
 73%|#######3  | 73/100 [00:07<00:02,  9.43it/s]
 74%|#######4  | 74/100 [00:08<00:02,  9.42it/s]
 75%|#######5  | 75/100 [00:08<00:02,  9.45it/s]
 76%|#######6  | 76/100 [00:08<00:02,  9.50it/s]
 77%|#######7  | 77/100 [00:08<00:02,  9.48it/s]
 78%|#######8  | 78/100 [00:08<00:02,  9.52it/s]
 79%|#######9  | 79/100 [00:08<00:02,  9.51it/s]
 80%|########  | 80/100 [00:08<00:02,  9.44it/s]
 81%|########1 | 81/100 [00:08<00:02,  9.42it/s]
 82%|########2 | 82/100 [00:08<00:01,  9.38it/s]
 83%|########2 | 83/100 [00:08<00:01,  9.36it/s]
 84%|########4 | 84/100 [00:09<00:01,  9.26it/s]
 85%|########5 | 85/100 [00:09<00:01,  9.26it/s]
 86%|########6 | 86/100 [00:09<00:01,  9.29it/s]
 87%|########7 | 87/100 [00:09<00:01,  9.29it/s]
 88%|########8 | 88/100 [00:09<00:01,  9.28it/s]
 89%|########9 | 89/100 [00:09<00:01,  9.36it/s]
 90%|######### | 90/100 [00:09<00:01,  9.34it/s]
 91%|#########1| 91/100 [00:09<00:00,  9.38it/s]
 92%|#########2| 92/100 [00:09<00:00,  9.42it/s]
 93%|#########3| 93/100 [00:10<00:00,  9.35it/s]
 94%|#########3| 94/100 [00:10<00:00,  9.24it/s]
 95%|#########5| 95/100 [00:10<00:00,  9.23it/s]
 96%|#########6| 96/100 [00:10<00:00,  9.23it/s]
 97%|#########7| 97/100 [00:10<00:00,  9.18it/s]
 98%|#########8| 98/100 [00:10<00:00,  9.15it/s]
 99%|#########9| 99/100 [00:10<00:00,  9.17it/s]
100%|##########| 100/100 [00:10<00:00,  9.18it/s]
100%|##########| 100/100 [00:10<00:00,  9.23it/s]
[Mamba-GNN] Computing Rank...

[Mamba-GNN] Rank:   0%|          | 0/10000 [00:00<?, ?it/s]
[Mamba-GNN] Rank:   4%|4         | 417/10000 [00:00<00:02, 4162.52it/s]
[Mamba-GNN] Rank:   8%|8         | 834/10000 [00:00<00:02, 3995.66it/s]
[Mamba-GNN] Rank:  12%|#2        | 1238/10000 [00:00<00:02, 4013.99it/s]
[Mamba-GNN] Rank:  16%|#6        | 1642/10000 [00:00<00:02, 4022.05it/s]
[Mamba-GNN] Rank:  20%|##        | 2045/10000 [00:00<00:02, 3973.36it/s]
[Mamba-GNN] Rank:  25%|##4       | 2452/10000 [00:00<00:01, 4005.57it/s]
[Mamba-GNN] Rank:  29%|##8       | 2853/10000 [00:00<00:01, 3998.52it/s]
[Mamba-GNN] Rank:  33%|###2      | 3260/10000 [00:00<00:01, 4019.42it/s]
[Mamba-GNN] Rank:  37%|###6      | 3663/10000 [00:00<00:01, 3917.09it/s]
[Mamba-GNN] Rank:  41%|####      | 4070/10000 [00:01<00:01, 3962.28it/s]
[Mamba-GNN] Rank:  45%|####4     | 4469/10000 [00:01<00:01, 3968.49it/s]
[Mamba-GNN] Rank:  49%|####8     | 4868/10000 [00:01<00:01, 3974.38it/s]
[Mamba-GNN] Rank:  53%|#####2    | 5266/10000 [00:01<00:01, 3964.58it/s]
[Mamba-GNN] Rank:  57%|#####6    | 5675/10000 [00:01<00:01, 3999.87it/s]
[Mamba-GNN] Rank:  61%|######    | 6076/10000 [00:01<00:00, 4002.63it/s]
[Mamba-GNN] Rank:  65%|######4   | 6477/10000 [00:01<00:00, 4002.40it/s]
[Mamba-GNN] Rank:  69%|######8   | 6878/10000 [00:01<00:00, 4003.84it/s]
[Mamba-GNN] Rank:  73%|#######2  | 7279/10000 [00:01<00:00, 3990.21it/s]
[Mamba-GNN] Rank:  77%|#######6  | 7689/10000 [00:01<00:00, 4021.73it/s]
[Mamba-GNN] Rank:  81%|########  | 8092/10000 [00:02<00:00, 4015.06it/s]
[Mamba-GNN] Rank:  85%|########4 | 8496/10000 [00:02<00:00, 4022.15it/s]
[Mamba-GNN] Rank:  89%|########8 | 8899/10000 [00:02<00:00, 4007.22it/s]
[Mamba-GNN] Rank:  93%|#########3| 9300/10000 [00:02<00:00, 3995.36it/s]
[Mamba-GNN] Rank:  97%|#########7| 9700/10000 [00:02<00:00, 3976.16it/s]
[Mamba-GNN] Final Rank: 66.0
[Mamba-GNN] Rank: 100%|##########| 10000/10000 [00:02<00:00, 3994.01it/s]
Starting Transformer eval...

[Transformer] Evaluating on data/ASCAD_desync50.h5...
File replaced with fixed version
Checkpoints deleted
NOW RESTART RUNTIME: Runtime -> Restart runtime
Then run your training again
WARNING:tensorflow:From C:\Users\User\AppData\Roaming\Python\Python313\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2026-02-17 18:37:50.720161: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[Transformer] Restoring from checkpoints/checkpoints_transformer_desync50\trans_long-5
[Transformer] Checkpoint restored.
[Transformer] Running Inference...

[1m 1/40[0m [37m====================[0m [1m1:32[0m 2s/step
[1m 2/40[0m [32m=[0m[37m===================[0m [1m1:13[0m 2s/step
[1m 3/40[0m [32m=[0m[37m===================[0m [1m1:11[0m 2s/step
[1m 4/40[0m [32m==[0m[37m==================[0m [1m1:09[0m 2s/step
[1m 5/40[0m [32m==[0m[37m==================[0m [1m1:06[0m 2s/step
[1m 6/40[0m [32m===[0m[37m=================[0m [1m1:04[0m 2s/step
[1m 7/40[0m [32m===[0m[37m=================[0m [1m1:02[0m 2s/step
[1m 8/40[0m [32m====[0m[37m================[0m [1m1:00[0m 2s/step
[1m 9/40[0m [32m====[0m[37m================[0m [1m58s[0m 2s/step 
[1m10/40[0m [32m=====[0m[37m===============[0m [1m56s[0m 2s/step
[1m11/40[0m [32m=====[0m[37m===============[0m [1m54s[0m 2s/step
[1m12/40[0m [32m======[0m[37m==============[0m [1m52s[0m 2s/step
[1m13/40[0m [32m======[0m[37m==============[0m [1m50s[0m 2s/step
[1m14/40[0m [32m=======[0m[37m=============[0m [1m48s[0m 2s/step
[1m15/40[0m [32m=======[0m[37m=============[0m [1m46s[0m 2s/step
[1m16/40[0m [32m========[0m[37m============[0m [1m45s[0m 2s/step
[1m17/40[0m [32m========[0m[37m============[0m [1m43s[0m 2s/step
[1m18/40[0m [32m=========[0m[37m===========[0m [1m41s[0m 2s/step
[1m19/40[0m [32m=========[0m[37m===========[0m [1m39s[0m 2s/step
[1m20/40[0m [32m==========[0m[37m==========[0m [1m37s[0m 2s/step
[1m21/40[0m [32m==========[0m[37m==========[0m [1m36s[0m 2s/step
[1m22/40[0m [32m===========[0m[37m=========[0m [1m34s[0m 2s/step
[1m23/40[0m [32m===========[0m[37m=========[0m [1m32s[0m 2s/step
[1m24/40[0m [32m============[0m[37m========[0m [1m30s[0m 2s/step
[1m25/40[0m [32m============[0m[37m========[0m [1m28s[0m 2s/step
[1m26/40[0m [32m=============[0m[37m=======[0m [1m26s[0m 2s/step
[1m27/40[0m [32m=============[0m[37m=======[0m [1m24s[0m 2s/step
[1m28/40[0m [32m==============[0m[37m======[0m [1m22s[0m 2s/step
[1m29/40[0m [32m==============[0m[37m======[0m [1m21s[0m 2s/step
[1m30/40[0m [32m===============[0m[37m=====[0m [1m19s[0m 2s/step
[1m31/40[0m [32m===============[0m[37m=====[0m [1m17s[0m 2s/step
[1m32/40[0m [32m================[0m[37m====[0m [1m15s[0m 2s/step
[1m33/40[0m [32m================[0m[37m====[0m [1m13s[0m 2s/step
[1m34/40[0m [32m=================[0m[37m===[0m [1m11s[0m 2s/step
[1m35/40[0m [32m=================[0m[37m===[0m [1m9s[0m 2s/step 
[1m36/40[0m [32m==================[0m[37m==[0m [1m7s[0m 2s/step
[1m37/40[0m [32m==================[0m[37m==[0m [1m5s[0m 2s/step
[1m38/40[0m [32m===================[0m[37m=[0m [1m3s[0m 2s/step
[1m39/40[0m [32m===================[0m[37m=[0m [1m1s[0m 2s/step
[1m40/40[0m [32m====================[0m[37m[0m [1m0s[0m 2s/step
[1m40/40[0m [32m====================[0m[37m[0m [1m76s[0m 2s/step
[Transformer] Computing Rank...

[Transformer] Rank:   0%|          | 0/1 [00:00<?, ?it/s]
[Transformer] Final Rank: 31.0
[Transformer] Rank: 100%|##########| 1/1 [00:00<00:00, 80.18it/s]
Comparison plot saved to desync50_comparison.png
